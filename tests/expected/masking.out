CREATE EXTENSION IF NOT EXISTS anon CASCADE;
SELECT anon.mask_init();
 mask_init 
-----------
(0 rows)

CREATE TEMPORARY TABLE t1 (
	id SERIAL,
	name TEXT,
	"CreditCard" TEXT,
	fk_company INTEGER
);
INSERT INTO t1 
VALUES (1,'Schwarzenegger','1234567812345678', 1991);
COMMENT ON COLUMN t1.name IS '  MASKED WITH FUNCTION anon.random_last_name() ';
COMMENT ON COLUMN t1."CreditCard" IS '  MASKED    WITH    FUNCTION         anon.random_string(12)';
CREATE TEMPORARY TABLE "T2" (
	id_company SERIAL,
	"IBAN" TEXT,
	COMPANY TEXT
);
INSERT INTO "T2"
VALUES (1991,'12345677890','Skynet');
COMMENT ON COLUMN "T2"."IBAN" IS 'MASKED WITH FUNCTION anon.random_iban()';
COMMENT ON COLUMN "T2".COMPANY IS 'jvnosdfnvsjdnvfskngvknfvg MASKED WITH FUNCTION anon.random_company() jenfk snvi  jdnvkjsnvsndvjs';
SELECT count(*) = 4  FROM anon.pg_masks;
 ?column? 
----------
 t
(1 row)

SELECT func = 'anon.random_iban()' FROM anon.pg_masks WHERE attname = 'IBAN';
 ?column? 
----------
 t
(1 row)

-- FIXME
SELECT anon.static_substitution();
 static_substitution 
---------------------
(0 rows)

SELECT company != 'Skynet' FROM "T2" WHERE id_company=1991;
 ?column? 
----------
 t
(1 row)

SELECT name != 'Schwarzenegger' FROM t1 WHERE id = 1; 
 ?column? 
----------
 t
(1 row)

DROP EXTENSION anon CASCADE;
NOTICE:  drop cascades to event trigger anon_mask_update
